{"version":3,"sources":["webpack:///./templates/gallery-card.hbs","webpack:///./js/form.js","webpack:///./js/fetchImage.js","webpack:///./index.js","webpack:///./js/generateMarkup.js","webpack:///./templates/form.hbs"],"names":["Handlebars","module","exports","template","container","depth0","helpers","partials","data","helper","alias1","nullContext","alias2","hooks","helperMissing","alias3","alias4","escapeExpression","lookupProperty","parent","propertyName","Object","prototype","hasOwnProperty","call","stack1","program","noop","overlay1","document","querySelector","overlay2","search","input","addEventListener","classList","toggle","onblur","removeAttribute","contains","setTimeout","focus","setAttribute","e","value","remove","body","target","length","keyCode","blur","_","debounce","add","FetchImage","pagesCount","this","searchQuery","getPageOfImagesByName","searchValue","localStorage","getItem","setItem","console","log","fetch","then","res","json","status","images","catch","error","notification","checkInput","newQuery","inputElement","imagesBlock","searchForm","button","storage","refs","imagesMarkup","init","onSearch","bind","loadMoreImagesMarkUp","event","fetchImage","clearImagesMarkUp","apply","query","trim","appendImagesMarkUp","clearInputField","children","viewImageByIntersectionObserver","options","root","rootMargin","threshold","IntersectionObserver","showImagesList","total","totalHits","hits","showImages","insertAdjacentHTML","galleryCardTpl","searchBlock","countriesListTpl","innerHTML"],"mappings":"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","file":"main.d36abba85a42020bc8f9.js","sourcesContent":["var Handlebars = require(\"../../node_modules/handlebars/runtime.js\");\nfunction __default(obj) { return obj && (obj.__esModule ? obj[\"default\"] : obj); }\nmodule.exports = (Handlebars[\"default\"] || Handlebars).template({\"1\":function(container,depth0,helpers,partials,data) {\n    var helper, alias1=depth0 != null ? depth0 : (container.nullContext || {}), alias2=container.hooks.helperMissing, alias3=\"function\", alias4=container.escapeExpression, lookupProperty = container.lookupProperty || function(parent, propertyName) {\n        if (Object.prototype.hasOwnProperty.call(parent, propertyName)) {\n          return parent[propertyName];\n        }\n        return undefined\n    };\n\n  return \"    <li class=\\\"gallery__image-item\\\">\\r\\n        <div class=\\\"photo-card\\\">\\r\\n            <div class=\\\"image-wrap\\\">\\r\\n                <img loading = \\\"lazy\\\" src=\\\"\"\n    + alias4(((helper = (helper = lookupProperty(helpers,\"webformatURL\") || (depth0 != null ? lookupProperty(depth0,\"webformatURL\") : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"webformatURL\",\"hash\":{},\"data\":data,\"loc\":{\"start\":{\"line\":5,\"column\":43},\"end\":{\"line\":5,\"column\":59}}}) : helper)))\n    + \"\\\" alt=\\\"\"\n    + alias4(((helper = (helper = lookupProperty(helpers,\"tags\") || (depth0 != null ? lookupProperty(depth0,\"tags\") : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"tags\",\"hash\":{},\"data\":data,\"loc\":{\"start\":{\"line\":5,\"column\":66},\"end\":{\"line\":5,\"column\":74}}}) : helper)))\n    + \"\\\"/>\\r\\n            </div>\\r\\n        \\r\\n            <div class=\\\"stats\\\">\\r\\n                <p class=\\\"stats-item\\\">\\r\\n                    <i class=\\\"material-icons\\\">thumb_up</i>\\r\\n                    \"\n    + alias4(((helper = (helper = lookupProperty(helpers,\"likes\") || (depth0 != null ? lookupProperty(depth0,\"likes\") : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"likes\",\"hash\":{},\"data\":data,\"loc\":{\"start\":{\"line\":11,\"column\":20},\"end\":{\"line\":11,\"column\":29}}}) : helper)))\n    + \"\\r\\n                </p>\\r\\n                <p class=\\\"stats-item\\\">\\r\\n                    <i class=\\\"material-icons\\\">visibility</i>\\r\\n                    \"\n    + alias4(((helper = (helper = lookupProperty(helpers,\"views\") || (depth0 != null ? lookupProperty(depth0,\"views\") : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"views\",\"hash\":{},\"data\":data,\"loc\":{\"start\":{\"line\":15,\"column\":20},\"end\":{\"line\":15,\"column\":29}}}) : helper)))\n    + \"\\r\\n                </p>\\r\\n                <p class=\\\"stats-item\\\">\\r\\n                    <i class=\\\"material-icons\\\">comment</i>\\r\\n                    \"\n    + alias4(((helper = (helper = lookupProperty(helpers,\"coments\") || (depth0 != null ? lookupProperty(depth0,\"coments\") : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"coments\",\"hash\":{},\"data\":data,\"loc\":{\"start\":{\"line\":19,\"column\":20},\"end\":{\"line\":19,\"column\":31}}}) : helper)))\n    + \"\\r\\n                </p>\\r\\n                <p class=\\\"stats-item\\\">\\r\\n                    <i class=\\\"material-icons\\\">cloud_download</i>\\r\\n                    \"\n    + alias4(((helper = (helper = lookupProperty(helpers,\"downloads\") || (depth0 != null ? lookupProperty(depth0,\"downloads\") : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"downloads\",\"hash\":{},\"data\":data,\"loc\":{\"start\":{\"line\":23,\"column\":20},\"end\":{\"line\":23,\"column\":33}}}) : helper)))\n    + \"\\r\\n                </p>\\r\\n            </div>\\r\\n        </div>\\r\\n    </li>\\r\\n\";\n},\"compiler\":[8,\">= 4.3.0\"],\"main\":function(container,depth0,helpers,partials,data) {\n    var stack1, lookupProperty = container.lookupProperty || function(parent, propertyName) {\n        if (Object.prototype.hasOwnProperty.call(parent, propertyName)) {\n          return parent[propertyName];\n        }\n        return undefined\n    };\n\n  return ((stack1 = lookupProperty(helpers,\"each\").call(depth0 != null ? depth0 : (container.nullContext || {}),depth0,{\"name\":\"each\",\"hash\":{},\"fn\":container.program(1, data, 0),\"inverse\":container.noop,\"data\":data,\"loc\":{\"start\":{\"line\":1,\"column\":0},\"end\":{\"line\":28,\"column\":9}}})) != null ? stack1 : \"\")\n    + \"\\r\\n\";\n},\"useData\":true});","import { debounce } from 'lodash';\r\n\r\nconst overlay1 = document.querySelector('.overlay-1');\r\nconst overlay2 = document.querySelector('.overlay-2');\r\nconst search   = document.querySelector('.search');\r\nconst input    = document.querySelector('.input');\r\n\r\n\r\nlet searchValue = '';\r\n\r\noverlay1.addEventListener('click', () => {\r\n  search.classList.toggle('active');\r\n    input.onblur = input.removeAttribute('placeholder');\r\n\r\n  if (search.classList.contains('active')) {\r\n    setTimeout(() => {\r\n      input.focus();\r\n    }, 200)\r\n  }\r\n})\r\n\r\nsearch.addEventListener('click', () => {\r\n  if (search.classList.contains('active')) {\r\n    setTimeout(() => {\r\n      input.focus();\r\n      input.setAttribute('placeholder', 'Search images...');\r\n    }, 200)\r\n  }\r\n})\r\n\r\noverlay2.addEventListener('click', (e) => {\r\n  input.value = '';\r\n  input.focus();\r\n  search.classList.remove('searching');\r\n  input.removeAttribute('placeholder');\r\n  input.classList.toggle('input__animation');\r\n})\r\n\r\ndocument.body.addEventListener('click', (e) => {\r\n  if (!search.contains(e.target) && input.value.length === 0) {\r\n    search.classList.remove('active');\r\n    search.classList.remove('searching');\r\n    input.value  = '';\r\n    input.onblur = input.removeAttribute('placeholder');\r\n  }\r\n})\r\n\r\ninput.addEventListener('keyup', (e) => {\r\n  if (e.keyCode === 13) {\r\n    input.blur();\r\n  }\r\n})\r\n\r\ninput.addEventListener('input', _.debounce(() => {\r\n  if (input.value.length > 0) {\r\n    input.classList.remove('input__animation');\r\n    search.classList.add('searching');\r\n    searchValue = input.value;\r\n    // localStorage.setItem(\"searchValue\", searchValue);\r\n  } else {\r\n    search.classList.remove('searching');\r\n  }\r\n}, 1000))\r\n\r\ninput.value = '';\r\ninput.blur();\r\n","// import { error } from \"@pnotify/core\";\r\n// import { notification } from './notification';\r\n\r\nexport default class FetchImage {\r\n  constructor(pagesCount) { // imageRequestValue,\r\n    this.searchQuery = '';\r\n    this.pagesCount = pagesCount;\r\n  }\r\n\r\n  getPageOfImagesByName(pagesCount, searchValue) { //, imageRequestValue\r\n    // let searchValue;\r\n    if (pagesCount > 1) {\r\n      searchValue = localStorage.getItem(searchValue);\r\n    } else {\r\n      searchValue = this.searchQuery;\r\n      localStorage.setItem('searchValue', searchValue);\r\n    }\r\n    // console.log(searchValue);\r\n    \r\n    console.log(this.pagesCount);\r\n    return fetch(`https://pixabay.com/api/?image_type=photo&orientation=horizontal&q=${searchValue}&page=${this.pagesCount}&per_page=12&key=19206966-979935191003b7da2f180a9ff`)\r\n      .then(res => res.json(), res => res.status)\r\n      .then(images => {return images;})\r\n      .catch(error=> notification('error', \"Enter country name!\"))\r\n  }\r\n  \r\n  checkInput() {\r\n    if(this.searchQuery = '') {\r\n      return;\r\n    }\r\n  }\r\n\r\n  get query() {\r\n    // if (this.pagesCount = 1) {\r\n      return this.searchQuery;\r\n    // } else {\r\n      return localStorage.getItem('searchValue');\r\n    // }\r\n  }\r\n\r\n  set query(newQuery) {\r\n    this.searchQuery = newQuery;\r\n  }\r\n}\r\n","import './js/form.js';\r\nimport '../css/normalize.css';\r\nimport '../css/reset.css';\r\nimport '../css/main.min.css';\r\n// import '@pnotify/core/dist/PNotify.css';\r\n// import '@pnotify/core/dist/BrightTheme.css';\r\nimport GenerateMarkup from './js/generateMarkup.js';\r\nimport FetchImage from './js/fetchImage.js'\r\n\r\n// let searchValue = localStorage.getItem('searchValue');\r\n\r\nconst renderMarkup = new GenerateMarkup(\r\n  {\r\n  inputElement: '.input',\r\n  imagesBlock:  '.gallery',\r\n  searchForm:   '.search-form',\r\n  button: '[data-load-more]',\r\n  storage: localStorage.getItem('searchValue'),\r\n  } \r\n);\r\n","import FetchImage from './fetchImage';\r\n// import countryListTpl   from '../templates/dropdown.hbs';\r\n// import countriesListTpl from '../templates/countries-list.hbs';\r\nimport galleryCardTpl from '../templates/gallery-card.hbs';\r\nimport formTpl from '../templates/form.hbs';\r\nimport './form.js';\r\n// import { notification } from './notification';\r\n// import searchValue from './form';\r\nimport { debounce, filter, bind } from 'lodash';\r\n\r\n// const debounce     = require('lodash.debounce');\r\n// const formOfSearch = require('./form.js').default;\r\n\r\nexport default class GenerateMarkup {\r\n  constructor({ inputElement, imagesBlock,  searchForm, button, storage}) { //, images\r\n    let pagesCount = 1;\r\n\r\n    this.refs = {\r\n      input:        document.querySelector(inputElement),\r\n      imagesMarkup: document.querySelector(imagesBlock),\r\n      searchForm:   document.querySelector(searchForm),\r\n      button:       document.querySelector(button),\r\n      storage:      storage,\r\n    }\r\n  \r\n    this.init();\r\n  }\r\n  \r\n  init() {\r\n    this.debounce = debounce(this.onSearch.bind(this), 500);\r\n    this.refs.input.addEventListener('input', this.debounce);\r\n    this.refs.button.addEventListener('click', this.loadMoreImagesMarkUp);\r\n   \r\n  }\r\n\r\n  onSearch(event) {   \r\n    const fetchImage = new FetchImage(this.pagesCount);\r\n\r\n    if (this.pagesCount = 1) {\r\n      this.clearImagesMarkUp.apply(this); \r\n      fetchImage.query = event.target.value.trim();\r\n      \r\n      if (fetchImage.query === '') {\r\n        this.clearInputField.bind(this);\r\n        return;\r\n      }\r\n    }\r\n    \r\n    return fetchImage.getPageOfImagesByName()\r\n      .then(this.appendImagesMarkUp.bind(this))\r\n      .then(this.clearInputField.bind(this))\r\n      .catch() //this.onCatchError.bind(this)\r\n  }\r\n\r\n  loadMoreImagesMarkUp(event) {\r\n    this.pagesCount = 2;\r\n    if (document.querySelector('.gallery').children.length > 0) {\r\n      this.pagesCount += 1;\r\n      // console.log(this.refs.imagesMarkup.children.length);\r\n      // localStorage.setItem('pagesCount', pagesCount);\r\n      // return;\r\n    } else {\r\n        this.clearInputField.bind(this);\r\n      return;\r\n    }\r\n    \r\n    const fetchImage = new FetchImage(this.pagesCount);//this.pagesCount, localStorage.getItem('searchValue')\r\n    console.log(`Load more pagesCount: ${this.pagesCount}`);\r\n    // console.log(this.refs.imagesMarkup.children.length);\r\n    \r\n    fetchImage.getPageOfImagesByName() //this.pagesCount, searchValueForLoadMoreMethod\r\n      .then(this.appendImagesMarkUp.bind(this))\r\n      .then(this.clearInputField.bind(this))\r\n      .catch() //this.onCatchError.bind(this)\r\n  }\r\n\r\n  viewImageByIntersectionObserver() {\r\n    let options = {\r\n      root:       document.querySelector(this.refs.imagesMarkup),\r\n      rootMargin: '0px',\r\n      threshold:  1.0\r\n    }\r\n    let observer = new IntersectionObserver(showImagesList, options);\r\n    this.onSearch();\r\n  }\r\n\r\n  appendImagesMarkUp(images) {\r\n    let { total, totalHits, hits } = images;\r\n    console.log(hits);\r\n\r\n    if (this.pagesCount = 1) { \r\n      this.clearImagesMarkUp();\r\n    }\r\n\r\n    this.showImages(hits);\r\n\r\n// //     if(countries.find (code => code.status === '404')){\r\n// //       return notification();\r\n// //     }\r\n\r\n//     // if (true) {\r\n//     //   this. imagesMarkup(images);\r\n//     //   return;\r\n//     // }\r\n    \r\n    // if (length >= 2 && length <= 10) {\r\n    //   this.clearImagesMarkUp.apply(this);\r\n    //   // this.showCountryListDropdown(countries);\r\n    //   this.showImagesList(hits);\r\n    //   return;\r\n    // }\r\n    \r\n// //     if (length > 10) {\r\n// //       notification();\r\n// //       return;\r\n// //     }\r\n  }\r\n\r\n  showImages(hits) {  \r\n    this.refs.imagesMarkup.insertAdjacentHTML('beforeend', galleryCardTpl(hits));\r\n    console.log(this.refs.imagesMarkup.children);\r\n    console.log(this.refs.imagesMarkup.children.length);\r\n  }\r\n\r\n// //   showCountryListDropdown(countries) {\r\n// //     this.refs.countriesMarkup.insertAdjacentHTML('beforeend', countryListTpl(countries));\r\n    \r\n// //     let inputCountry = document.querySelector('.js-search');\r\n// //     inputCountry.setAttribute(\"list\", \"countries-list\");\r\n// //   }\r\n\r\n  showImagesList(hits) {\r\n      // let { singleImage } = hints;\r\n     if (this.refs.imagesMarkup.children.length > 0) {\r\n       this.pagesCount += 1;\r\n       this.onSearch;\r\n    }\r\n\r\n    this.refs.searchBlock.insertAdjacentHTML('beforeend', countriesListTpl(hits)); \r\n\r\n    // const lazyImages = document.querySelectorAll('img[loading=\"lazy\"]');\r\n  \r\n    // lazyImages.forEach(image => {\r\n    //   image.addEventListener('load', onImageLoaded, { once: true });\r\n    // }); \r\n  }\r\n\r\n  clearImagesMarkUp() {\r\n    return this.refs.imagesMarkup.innerHTML = '';\r\n  }\r\n\r\n  clearInputField() {\r\n    return this.refs.input.value = '';\r\n  }\r\n\r\n// //   onCatchError() {\r\n// //     this.clearInputField();\r\n// //     notification();\r\n// //     return;\r\n// //   }\r\n}\r\n","var Handlebars = require(\"../../node_modules/handlebars/runtime.js\");\nfunction __default(obj) { return obj && (obj.__esModule ? obj[\"default\"] : obj); }\nmodule.exports = (Handlebars[\"default\"] || Handlebars).template({\"compiler\":[8,\">= 4.3.0\"],\"main\":function(container,depth0,helpers,partials,data) {\n    return \"<div class=\\\"search\\\">\\r\\n    <input class=\\\"input\\\" type=\\\"text\\\">\\r\\n    <svg viewBox=\\\"0 0 700 100\\\" class=\\\"magnifying-glass\\\">\\r\\n        <path class=\\\"magnifying-glass-path\\\"\\r\\n            d=\\\"m 59.123035,59.123035 c -10.561361,10.56136 -27.684709,10.56136 -38.24607,0 -10.56136,-10.561361 -10.56136,-27.684709 0,-38.24607 10.561361,-10.56136 27.684709,-10.56136 38.24607,0 10.56136,10.561361 10.56136,27.684709 0,38.24607 l 28.876965,28.876965 c 6.304625,7.101523 5.754679,-0.187815 13.07143,-0.5 h 582.04101\\\" />\\r\\n        <path class=\\\"x\\\"\\r\\n            d=\\\"m 673.46803,25.714286 -37.17876,38.816532 c 0,0 -5.08857,5.60515 -5.68529,11.841734 -1.06622,11.143538 13.02902,11.127448 13.02902,11.127448\\\" />\\r\\n        <path class=\\\"x\\\"\\r\\n            d=\\\"m 635.08021,25.714286 37.17876,38.816532 c 0,0 5.08857,5.60515 5.68529,11.841734 1.06622,11.143538 -13.02902,11.127448 -13.02902,11.127448\\\" />\\r\\n    </svg>\\r\\n    <div class=\\\"overlay overlay-1\\\"></div>\\r\\n    <div class=\\\"overlay overlay-2\\\"></div>\\r\\n</div>\\r\\n\";\n},\"useData\":true});"],"sourceRoot":""}